<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psyche Lens</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@google/generative-ai@0.1.0/dist/index.umd.js"></script>

    <style>
        body { background: #020617; color: #f1f5f9; font-family: 'Inter', sans-serif; margin: 0; }
        .dream-bg { background: radial-gradient(circle at 50% 50%, #1e1b4b 0%, #0f172a 50%, #020617 100%); min-height: 100vh; position: relative; }
        .glass { background: rgba(15, 23, 42, 0.6); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .stars { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; }
        .star { position: absolute; background: white; border-radius: 50%; animation: blink var(--d) infinite; }
        @keyframes blink { 0%, 100% { opacity: 0.3; } 50% { opacity: 1; } }
        /* Stile barre originali */
        .bar-bg { height: 8px; border-radius: 10px; background: rgba(255,255,255,0.05); }
        .bar-fill { height: 100%; border-radius: 10px; background: linear-gradient(90deg, #6366f1, #a855f7); }
    </style>
</head>
<body>
    <div class="dream-bg">
        <div class="stars" id="starfield"></div>
        <div id="root"></div>
    </div>

    <script>
        // Ricostruzione stelle
        const field = document.getElementById('starfield');
        for(let i=0; i<150; i++) {
            const s = document.createElement('div');
            s.className = 'star';
            s.style.width = s.style.height = Math.random()*2+'px';
            s.style.left = Math.random()*100+'%';
            s.style.top = Math.random()*100+'%';
            s.style.setProperty('--d', Math.random()*3+2+'s');
            field.appendChild(s);
        }

        const { useState } = React;
        const API_KEY = 'AIzaSyAtoTeJ676aX2EjEMZZ58ax2FgaBqxbMx8'; //

        const App = () => {
            const [input, setInput] = useState('');
            const [data, setData] = useState(null);
            const [loading, setLoading] = useState(false);

            const analyze = async () => {
                if(!input.trim()) return;
                setLoading(true);
                try {
                    const genAI = new window.GoogleGenerativeAI.GoogleGenerativeAI(API_KEY);
                    const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });
                    // Schema identico alla tua immagine originale
                    const prompt = `Analizza il sogno e rispondi SOLO in JSON:
                    {
                      "title": "Titolo",
                      "phrase": "Frase di sintesi",
                      "category": "Shadow",
                      "emotions": [{"label": "Anxiety", "value": 70}],
                      "analysis": "Testo analisi",
                      "suggestions": "Testo suggerimenti"
                    }
                    Sogno: ${input}`;
                    
                    const res = await model.generateContent(prompt);
                    const text = res.response.text().replace(/```json|```/g, "");
                    setData(JSON.parse(text));
                } catch(e) { alert("Errore"); }
                setLoading(false);
            };

            return React.createElement('div', { className: "relative z-10 max-w-2xl mx-auto px-6 py-16" },
                React.createElement('h1', { className: "text-5xl font-bold text-center text-indigo-300 italic mb-2", style: { fontFamily: 'Libre Baskerville' } }, "Psyche Lens"),
                React.createElement('p', { className: "text-center text-slate-500 uppercase tracking-[0.5em] text-[10px] mb-12" }, "Archetypal Dream Analysis"),

                !data ? React.createElement('
